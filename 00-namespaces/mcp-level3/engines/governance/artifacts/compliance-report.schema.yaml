# Compliance Report Artifact Schema
# Defines the structure for compliance reports in governance systems

version: "1.0.0"
semantic_role: "compliance_report"
artifact_type: "schema"
semantic_root: true

metadata:
  name: "compliance-report"
  description: "Schema for compliance reports mapping to regulatory frameworks"
  author: "MCP Core Team"
  created: "2025-01-11"
  updated: "2025-01-11"
  tags:
    - "governance"
    - "compliance"
    - "regulatory"
    - "audit"

schema:
  type: "object"
  required:
    - "report_id"
    - "framework"
    - "assessment_period"
    - "compliance_status"
    - "findings"
    - "metadata"
  properties:
    report_id:
      type: "string"
      pattern: "^report:[a-zA-Z0-9_-]+:[0-9]+$"
      example: "report:compliance:20250111_Q1"
      
    framework:
      type: "object"
      required:
        - "name"
        - "version"
      properties:
        name:
          type: "string"
          enum: ["GDPR", "SOC2", "HIPAA", "ISO27001", "PCI-DSS"]
          example: "GDPR"
        version:
          type: "string"
          example: "2016/679"
        requirements:
          type: "array"
          items:
            type: "object"
            properties:
              requirement_id:
                type: "string"
                example: "Article 32"
              description:
                type: "string"
                example: "Security of processing"
              status:
                type: "string"
                enum: ["compliant", "non_compliant", "partial", "not_applicable"]
                example: "compliant"
                
    assessment_period:
      type: "object"
      required:
        - "start_date"
        - "end_date"
      properties:
        start_date:
          type: "string"
          format: "date"
          example: "2025-01-01"
        end_date:
          type: "string"
          format: "date"
          example: "2025-03-31"
          
    compliance_status:
      type: "object"
      required:
        - "overall_status"
        - "compliance_score"
      properties:
        overall_status:
          type: "string"
          enum: ["compliant", "non_compliant", "partial"]
          example: "compliant"
        compliance_score:
          type: "number"
          minimum: 0
          maximum: 100
          example: 95.5
        total_requirements:
          type: "integer"
          example: 50
        compliant_requirements:
          type: "integer"
          example: 48
        non_compliant_requirements:
          type: "integer"
          example: 2
          
    findings:
      type: "array"
      items:
        type: "object"
        properties:
          finding_id:
            type: "string"
            example: "finding:001"
          severity:
            type: "string"
            enum: ["critical", "high", "medium", "low"]
            example: "high"
          requirement_id:
            type: "string"
            example: "Article 32"
          description:
            type: "string"
            example: "Insufficient encryption for data at rest"
          remediation:
            type: "string"
            example: "Implement AES-256 encryption"
          status:
            type: "string"
            enum: ["open", "in_progress", "resolved", "accepted_risk"]
            example: "in_progress"
            
    metadata:
      type: "object"
      required:
        - "generated_at"
        - "assessor"
      properties:
        generated_at:
          type: "string"
          format: "date-time"
          example: "2025-01-11T10:00:00Z"
        assessor:
          type: "string"
          example: "user:compliance_officer"
        next_assessment_date:
          type: "string"
          format: "date"
          example: "2025-04-01"

validation_rules:
  - rule: "report_id_format"
    description: "Report ID must follow naming convention"
    expression: "report_id matches pattern 'report:type:period'"

examples:
  - name: "gdpr_compliance_report"
    description: "GDPR compliance assessment report"
    data:
      report_id: "report:compliance:20250111_Q1"
      framework:
        name: "GDPR"
        version: "2016/679"
        requirements:
          - requirement_id: "Article 32"
            description: "Security of processing"
            status: "compliant"
      assessment_period:
        start_date: "2025-01-01"
        end_date: "2025-03-31"
      compliance_status:
        overall_status: "compliant"
        compliance_score: 95.5
        total_requirements: 50
        compliant_requirements: 48
        non_compliant_requirements: 2
      findings:
        - finding_id: "finding:001"
          severity: "high"
          requirement_id: "Article 32"
          description: "Insufficient encryption for data at rest"
          remediation: "Implement AES-256 encryption"
          status: "in_progress"
      metadata:
        generated_at: "2025-01-11T10:00:00Z"
        assessor: "user:compliance_officer"
        next_assessment_date: "2025-04-01"

usage_guidelines:
  - "Conduct regular compliance assessments"
  - "Track remediation of findings"
  - "Maintain audit trail of compliance status"
  - "Schedule periodic reassessments"