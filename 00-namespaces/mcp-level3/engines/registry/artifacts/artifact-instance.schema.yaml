# Artifact Instance Schema
# Defines the structure for registered artifact instances

version: "1.0.0"
semantic_role: "artifact_instance"
artifact_type: "schema"
semantic_root: true

metadata:
  name: "artifact-instance"
  description: "Schema for artifact instances in the registry with versioning and metadata"
  author: "MCP Core Team"
  created: "2025-01-11"
  updated: "2025-01-11"
  tags:
    - "registry"
    - "artifact"
    - "versioning"
    - "metadata"

schema:
  type: "object"
  required:
    - "artifact_id"
    - "artifact_type"
    - "version"
    - "content"
    - "metadata"
  properties:
    artifact_id:
      type: "string"
      description: "Unique identifier for the artifact"
      pattern: "^artifact:[a-zA-Z0-9_-]+:[a-zA-Z0-9_.-]+$"
      example: "artifact:model:customer_churn_v1.0"
      
    artifact_type:
      type: "string"
      description: "Type of artifact"
      enum: ["model", "dataset", "schema", "policy", "workflow", "config"]
      example: "model"
      
    version:
      type: "string"
      description: "Semantic version"
      pattern: "^[0-9]+\\.[0-9]+\\.[0-9]+$"
      example: "1.0.0"
      
    content:
      type: "object"
      description: "Artifact content or reference"
      properties:
        storage_type:
          type: "string"
          enum: ["inline", "reference", "url"]
          example: "reference"
        storage_location:
          type: "string"
          example: "s3://artifacts/models/customer_churn_v1.0"
        content_hash:
          type: "string"
          description: "SHA-256 hash of content"
          example: "sha256:abc123..."
        size_bytes:
          type: "integer"
          minimum: 0
          example: 1048576
          
    metadata:
      type: "object"
      required:
        - "created_at"
        - "created_by"
      properties:
        created_at:
          type: "string"
          format: "date-time"
          example: "2025-01-11T10:00:00Z"
        created_by:
          type: "string"
          example: "user:ml_engineer"
        updated_at:
          type: "string"
          format: "date-time"
          example: "2025-01-11T12:00:00Z"
        tags:
          type: "array"
          items:
            type: "string"
          example: ["ml", "production", "churn-prediction"]
        description:
          type: "string"
          example: "Customer churn prediction model"
        owner:
          type: "string"
          example: "team:ml_platform"
          
    lineage:
      type: "object"
      description: "Artifact lineage"
      properties:
        parent_artifacts:
          type: "array"
          items:
            type: "string"
          example: ["artifact:dataset:training_data_v1.0"]
        derived_from:
          type: "string"
          example: "artifact:model:customer_churn_v0.9"
        lineage_graph_id:
          type: "string"
          example: "lineage:model_v1:001"
          
    status:
      type: "object"
      description: "Artifact status"
      properties:
        state:
          type: "string"
          enum: ["draft", "registered", "validated", "promoted", "deprecated", "archived"]
          example: "promoted"
        environment:
          type: "string"
          enum: ["development", "staging", "production"]
          example: "production"

validation_rules:
  - rule: "artifact_id_format"
    description: "Artifact ID must follow naming convention"
    expression: "artifact_id matches pattern 'artifact:type:name'"
    
  - rule: "version_format"
    description: "Version must be semantic version"
    expression: "version matches semver pattern"

examples:
  - name: "ml_model_artifact"
    description: "ML model artifact instance"
    data:
      artifact_id: "artifact:model:customer_churn_v1.0"
      artifact_type: "model"
      version: "1.0.0"
      content:
        storage_type: "reference"
        storage_location: "s3://artifacts/models/customer_churn_v1.0"
        content_hash: "sha256:abc123def456..."
        size_bytes: 1048576
      metadata:
        created_at: "2025-01-11T10:00:00Z"
        created_by: "user:ml_engineer"
        updated_at: "2025-01-11T12:00:00Z"
        tags: ["ml", "production", "churn-prediction"]
        description: "Customer churn prediction model"
        owner: "team:ml_platform"
      lineage:
        parent_artifacts: ["artifact:dataset:training_data_v1.0"]
        derived_from: "artifact:model:customer_churn_v0.9"
        lineage_graph_id: "lineage:model_v1:001"
      status:
        state: "promoted"
        environment: "production"

usage_guidelines:
  - "Use semantic versioning for all artifacts"
  - "Track lineage for reproducibility"
  - "Compute and store content hashes"
  - "Tag artifacts for discoverability"
  - "Maintain artifact lifecycle states"