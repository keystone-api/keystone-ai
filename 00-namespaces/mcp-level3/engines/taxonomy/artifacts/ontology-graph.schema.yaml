# MCP Level 3 - Taxonomy Engine: Ontology Graph Schema
# Purpose: Define semantic ontology graphs with concepts, properties, and relationships
# Version: 1.0.0
# Last Updated: 2025-01-11

schema:
  name: ontology-graph
  version: "1.0.0"
  namespace: mcp.level3.taxonomy.artifacts
  description: |
    Ontology graph artifact for representing semantic knowledge structures.
    Supports OWL/RDF-style ontologies with classes, properties, and axioms.
    Enables reasoning, inference, and semantic interoperability.

  type: object
  required:
    - ontology_id
    - name
    - version
    - classes
    - created_at
  
  properties:
    # Core Identity
    ontology_id:
      type: string
      format: uuid
      description: Unique identifier for the ontology
      example: "550e8400-e29b-41d4-a716-446655440000"
      index: true
    
    name:
      type: string
      description: Ontology name
      example: "MCP Domain Ontology"
      minLength: 3
      maxLength: 200
    
    namespace:
      type: string
      format: uri
      description: Ontology namespace URI
      example: "http://example.com/ontologies/mcp#"
    
    version:
      type: string
      pattern: '^\d+\.\d+\.\d+$'
      description: Semantic version
      example: "1.0.0"
    
    description:
      type: string
      description: Detailed ontology description
      example: "Formal ontology for MCP Level 3 domain concepts and relationships"
      maxLength: 2000
      optional: true
    
    # Classes (Concepts)
    classes:
      type: array
      description: Ontology classes (concepts)
      items:
        type: object
        required:
          - class_id
          - name
          - type
        properties:
          class_id:
            type: string
            format: uuid
            description: Unique class identifier
            example: "660e8400-e29b-41d4-a716-446655440001"
          
          name:
            type: string
            description: Class name
            example: "Artifact"
            pattern: '^[A-Z][a-zA-Z0-9]*$'
          
          uri:
            type: string
            format: uri
            description: Full URI of the class
            example: "http://example.com/ontologies/mcp#Artifact"
          
          type:
            type: string
            enum:
              - class
              - abstract_class
              - interface
              - enumeration
            description: Type of class
            example: "class"
          
          label:
            type: object
            description: Multi-language labels
            additionalProperties:
              type: string
            example:
              en: "Artifact"
              zh: "工件"
          
          description:
            type: object
            description: Multi-language descriptions
            additionalProperties:
              type: string
            example:
              en: "A reusable component or output in the MCP system"
          
          super_classes:
            type: array
            description: Parent classes (inheritance)
            items:
              type: string
              format: uuid
            example:
              - "770e8400-e29b-41d4-a716-446655440002"
            optional: true
          
          sub_classes:
            type: array
            description: Child classes
            items:
              type: string
              format: uuid
            optional: true
          
          disjoint_with:
            type: array
            description: Classes that are disjoint (mutually exclusive)
            items:
              type: string
              format: uuid
            optional: true
          
          equivalent_to:
            type: array
            description: Equivalent classes
            items:
              type: string
              format: uuid
            optional: true
          
          properties:
            type: array
            description: Properties defined for this class
            items:
              type: string
              format: uuid
            optional: true
          
          constraints:
            type: array
            description: Class constraints and restrictions
            items:
              type: object
              properties:
                type:
                  type: string
                  enum:
                    - cardinality
                    - value
                    - type
                    - range
                  description: Constraint type
                property:
                  type: string
                  description: Property the constraint applies to
                value:
                  description: Constraint value
            optional: true
          
          metadata:
            type: object
            description: Additional class metadata
            optional: true
            properties:
              deprecated:
                type: boolean
                description: Whether class is deprecated
                default: false
              since_version:
                type: string
                description: Version when class was introduced
              tags:
                type: array
                items:
                  type: string
                description: Classification tags
      minItems: 1
    
    # Properties
    properties:
      type: array
      description: Ontology properties (relationships and attributes)
      items:
        type: object
        required:
          - property_id
          - name
          - type
        properties:
          property_id:
            type: string
            format: uuid
            description: Unique property identifier
            example: "880e8400-e29b-41d4-a716-446655440003"
          
          name:
            type: string
            description: Property name
            example: "hasVersion"
            pattern: '^[a-z][a-zA-Z0-9]*$'
          
          uri:
            type: string
            format: uri
            description: Full URI of the property
            example: "http://example.com/ontologies/mcp#hasVersion"
          
          type:
            type: string
            enum:
              - object_property
              - data_property
              - annotation_property
            description: Property type
            example: "data_property"
          
          label:
            type: object
            description: Multi-language labels
            additionalProperties:
              type: string
            example:
              en: "has version"
          
          description:
            type: object
            description: Multi-language descriptions
            additionalProperties:
              type: string
            example:
              en: "Specifies the version of an artifact"
          
          domain:
            type: array
            description: Classes this property can be applied to
            items:
              type: string
              format: uuid
            example:
              - "660e8400-e29b-41d4-a716-446655440001"
          
          range:
            type: array
            description: Valid values/classes for this property
            items:
              type: object
              properties:
                type:
                  type: string
                  enum:
                    - class
                    - datatype
                  description: Range type
                value:
                  type: string
                  description: Class ID or datatype
            example:
              - type: "datatype"
                value: "string"
          
          characteristics:
            type: array
            description: Property characteristics
            items:
              type: string
              enum:
                - functional
                - inverse_functional
                - transitive
                - symmetric
                - asymmetric
                - reflexive
                - irreflexive
            example:
              - "functional"
            optional: true
          
          inverse_of:
            type: string
            format: uuid
            description: Inverse property
            optional: true
          
          super_properties:
            type: array
            description: Parent properties
            items:
              type: string
              format: uuid
            optional: true
          
          sub_properties:
            type: array
            description: Child properties
            items:
              type: string
              format: uuid
            optional: true
      optional: true
    
    # Individuals (Instances)
    individuals:
      type: array
      description: Named individuals (instances of classes)
      items:
        type: object
        required:
          - individual_id
          - name
          - class_id
        properties:
          individual_id:
            type: string
            format: uuid
            description: Unique individual identifier
          
          name:
            type: string
            description: Individual name
          
          uri:
            type: string
            format: uri
            description: Full URI of the individual
          
          class_id:
            type: string
            format: uuid
            description: Class this individual belongs to
          
          property_values:
            type: array
            description: Property values for this individual
            items:
              type: object
              properties:
                property_id:
                  type: string
                  format: uuid
                value:
                  description: Property value
          
          same_as:
            type: array
            description: Equivalent individuals
            items:
              type: string
              format: uuid
            optional: true
          
          different_from:
            type: array
            description: Different individuals
            items:
              type: string
              format: uuid
            optional: true
      optional: true
    
    # Axioms
    axioms:
      type: array
      description: Logical axioms and rules
      items:
        type: object
        required:
          - axiom_id
          - type
          - expression
        properties:
          axiom_id:
            type: string
            format: uuid
            description: Unique axiom identifier
          
          type:
            type: string
            enum:
              - subclass_of
              - equivalent_classes
              - disjoint_classes
              - subproperty_of
              - equivalent_properties
              - inverse_properties
              - property_domain
              - property_range
              - functional_property
              - inverse_functional_property
              - transitive_property
              - symmetric_property
              - class_assertion
              - property_assertion
              - same_individual
              - different_individuals
            description: Axiom type
          
          expression:
            type: string
            description: Logical expression in Manchester syntax or SPARQL
            example: "Artifact SubClassOf hasVersion some string"
          
          description:
            type: string
            description: Human-readable axiom description
            optional: true
      optional: true
    
    # Imports
    imports:
      type: array
      description: Imported ontologies
      items:
        type: object
        properties:
          ontology_id:
            type: string
            format: uuid
            description: Imported ontology ID
          namespace:
            type: string
            format: uri
            description: Imported ontology namespace
          version:
            type: string
            description: Imported ontology version
      optional: true
    
    # Annotations
    annotations:
      type: object
      description: Ontology-level annotations
      optional: true
      properties:
        creator:
          type: string
          description: Ontology creator
          example: "MCP Governance Team"
        contributor:
          type: array
          items:
            type: string
          description: Contributors
        license:
          type: string
          description: License information
          example: "MIT"
        rights:
          type: string
          description: Rights statement
        source:
          type: string
          description: Source of the ontology
        see_also:
          type: array
          items:
            type: string
            format: uri
          description: Related resources
    
    # Reasoning Configuration
    reasoning:
      type: object
      description: Reasoning engine configuration
      optional: true
      properties:
        enabled:
          type: boolean
          description: Enable reasoning
          default: true
        reasoner:
          type: string
          enum:
            - hermit
            - pellet
            - fact++
            - elk
            - jfact
          description: Reasoning engine
          example: "hermit"
        infer_property_values:
          type: boolean
          description: Infer property values
          default: true
        infer_class_hierarchy:
          type: boolean
          description: Infer class hierarchy
          default: true
        consistency_check:
          type: boolean
          description: Check ontology consistency
          default: true
    
    # Statistics
    statistics:
      type: object
      description: Ontology statistics
      optional: true
      properties:
        class_count:
          type: integer
          minimum: 0
          description: Number of classes
        property_count:
          type: integer
          minimum: 0
          description: Number of properties
        individual_count:
          type: integer
          minimum: 0
          description: Number of individuals
        axiom_count:
          type: integer
          minimum: 0
          description: Number of axioms
        max_depth:
          type: integer
          minimum: 0
          description: Maximum class hierarchy depth
    
    # Timestamps
    created_at:
      type: string
      format: date-time
      description: Creation timestamp
      example: "2025-01-01T00:00:00Z"
    
    updated_at:
      type: string
      format: date-time
      description: Last update timestamp
      example: "2025-01-11T10:00:00Z"
      optional: true
    
    # Metadata
    metadata:
      type: object
      description: Additional metadata
      optional: true
      properties:
        format:
          type: string
          enum:
            - owl
            - rdf
            - rdfs
            - skos
            - custom
          description: Ontology format
          example: "owl"
        serialization:
          type: string
          enum:
            - rdf-xml
            - turtle
            - n-triples
            - json-ld
            - manchester
          description: Serialization format
          example: "turtle"
        documentation_url:
          type: string
          format: uri
          description: Documentation URL
        tags:
          type: array
          items:
            type: string
          description: Classification tags

  # Validation Rules
  validation:
    rules:
      - name: unique_class_ids
        condition: all_unique(classes, 'class_id')
        message: "All class IDs must be unique"
        severity: error
      
      - name: valid_super_classes
        condition: all_references_exist(classes, 'super_classes', classes, 'class_id')
        message: "All super class references must exist"
        severity: error
      
      - name: no_circular_inheritance
        condition: no_cycles_in_hierarchy(classes)
        message: "Class hierarchy must not contain cycles"
        severity: error
      
      - name: valid_property_domain
        condition: all_references_exist(properties, 'domain', classes, 'class_id')
        message: "Property domain must reference existing classes"
        severity: error
      
      - name: consistent_axioms
        condition: axioms_are_consistent()
        message: "Axioms must be logically consistent"
        severity: error

  # Indexes
  indexes:
    - fields: [ontology_id]
      unique: true
    - fields: [name, version]
    - fields: [namespace]

# Usage Examples
examples:
  - name: mcp_domain_ontology
    description: Core MCP domain ontology
    data:
      ontology_id: "550e8400-e29b-41d4-a716-446655440000"
      name: "MCP Domain Ontology"
      namespace: "http://example.com/ontologies/mcp#"
      version: "1.0.0"
      description: "Formal ontology for MCP Level 3 domain concepts"
      classes:
        - class_id: "660e8400-e29b-41d4-a716-446655440001"
          name: "Artifact"
          uri: "http://example.com/ontologies/mcp#Artifact"
          type: "class"
          label:
            en: "Artifact"
            zh: "工件"
          description:
            en: "A reusable component or output in the MCP system"
          properties:
            - "880e8400-e29b-41d4-a716-446655440003"
            - "880e8400-e29b-41d4-a716-446655440004"
        - class_id: "660e8400-e29b-41d4-a716-446655440002"
          name: "DataArtifact"
          uri: "http://example.com/ontologies/mcp#DataArtifact"
          type: "class"
          label:
            en: "Data Artifact"
          description:
            en: "An artifact containing data"
          super_classes:
            - "660e8400-e29b-41d4-a716-446655440001"
      properties:
        - property_id: "880e8400-e29b-41d4-a716-446655440003"
          name: "hasVersion"
          uri: "http://example.com/ontologies/mcp#hasVersion"
          type: "data_property"
          label:
            en: "has version"
          description:
            en: "Specifies the version of an artifact"
          domain:
            - "660e8400-e29b-41d4-a716-446655440001"
          range:
            - type: "datatype"
              value: "string"
          characteristics:
            - "functional"
        - property_id: "880e8400-e29b-41d4-a716-446655440004"
          name: "dependsOn"
          uri: "http://example.com/ontologies/mcp#dependsOn"
          type: "object_property"
          label:
            en: "depends on"
          description:
            en: "Indicates a dependency relationship"
          domain:
            - "660e8400-e29b-41d4-a716-446655440001"
          range:
            - type: "class"
              value: "660e8400-e29b-41d4-a716-446655440001"
          characteristics:
            - "transitive"
      axioms:
        - axiom_id: "990e8400-e29b-41d4-a716-446655440005"
          type: "subclass_of"
          expression: "DataArtifact SubClassOf Artifact"
          description: "All data artifacts are artifacts"
      reasoning:
        enabled: true
        reasoner: "hermit"
        infer_property_values: true
        infer_class_hierarchy: true
        consistency_check: true
      statistics:
        class_count: 2
        property_count: 2
        individual_count: 0
        axiom_count: 1
        max_depth: 1
      created_at: "2025-01-01T00:00:00Z"
      updated_at: "2025-01-11T10:00:00Z"
      metadata:
        format: "owl"
        serialization: "turtle"
        tags:
          - "mcp"
          - "domain"
          - "core"

# Integration Guidelines
integration:
  creation:
    - Define ontology scope and purpose
    - Identify key concepts (classes)
    - Define relationships (properties)
    - Specify constraints (axioms)
    - Validate with reasoning engine
  
  usage:
    - Use for semantic annotation
    - Enable reasoning and inference
    - Support semantic search
    - Facilitate data integration
    - Enable knowledge discovery
  
  maintenance:
    - Version control ontology changes
    - Maintain backward compatibility
    - Document breaking changes
    - Provide migration guides

# Performance Considerations
performance:
  reasoning:
    - Cache reasoning results
    - Use incremental reasoning
    - Optimize axiom complexity
    - Consider reasoning scalability
  
  storage:
    - Use triple store for large ontologies
    - Index frequently queried patterns
    - Implement efficient SPARQL queries
    - Cache ontology structure