version: "2.0.0"
semantic_role: deployment_bundle
artifact_type: bundle
semantic_root: false
module: integration-extension

description: |
  Complete deployment bundle for the Integration & Extension module.
  Includes all source files, dependencies, configuration, and deployment
  strategies for adapters, plugins, middleware, and extensions.

# ============================================================================
# COMPONENT INVENTORY
# ============================================================================

components:
  # Protocol Adapters (4 files + 4 index files)
  adapters:
    - path: "src/integration/adapters/rest/rest-adapter.ts"
      type: "implementation"
      size: "31.2 KB"
      lines: 890
      exports: ["RESTAdapter", "IRESTAdapter"]
      
    - path: "src/integration/adapters/graphql/graphql-adapter.ts"
      type: "implementation"
      size: "28.7 KB"
      lines: 820
      exports: ["GraphQLAdapter", "IGraphQLAdapter"]
      
    - path: "src/integration/adapters/grpc/grpc-adapter.ts"
      type: "implementation"
      size: "26.4 KB"
      lines: 750
      exports: ["GRPCAdapter", "IGRPCAdapter"]
      
    - path: "src/integration/adapters/webhook/webhook-adapter.ts"
      type: "implementation"
      size: "23.8 KB"
      lines: 680
      exports: ["WebhookAdapter", "IWebhookAdapter"]
      
  # Plugin System (1 file)
  plugins:
    - path: "src/integration/plugins/plugin-system.ts"
      type: "implementation"
      size: "22.1 KB"
      lines: 630
      exports: ["PluginSystem", "IPluginSystem"]
      
  # Extensions (1 file)
  extensions:
    - path: "src/integration/extensions/extension-manager.ts"
      type: "implementation"
      size: "37.5 KB"
      lines: 1070
      exports: ["ExtensionManager", "IExtensionManager"]
      
  # Middleware (1 file)
  middleware:
    - path: "src/integration/middleware/middleware-chain.ts"
      type: "implementation"
      size: "21.3 KB"
      lines: 610
      exports: ["MiddlewareChain", "IMiddlewareChain"]
      
  # Event Bridge (1 file)
  events:
    - path: "src/integration/events/event-bridge.ts"
      type: "implementation"
      size: "33.6 KB"
      lines: 960
      exports: ["EventBridge", "IEventBridge"]
      
  # Registry (1 file)
  registry:
    - path: "src/integration/registry/adapter-registry.ts"
      type: "implementation"
      size: "23.9 KB"
      lines: 680
      exports: ["AdapterRegistry", "IAdapterRegistry"]
      
  # Integration Bridge (1 file)
  bridge:
    - path: "src/integration/integration-bridge.ts"
      type: "implementation"
      size: "19.7 KB"
      lines: 560
      exports: ["IntegrationBridge"]
      
  # Index files (6 files)
  index:
    - path: "src/integration/index.ts"
      type: "barrel"
      size: "5.2 KB"
      lines: 148
      exports: ["*"]

# ============================================================================
# DEPENDENCIES
# ============================================================================

dependencies:
  internal:
    - module: "@mcp/protocol"
      version: "^2.0.0"
      components: ["Request", "Response"]
      
    - module: "@mcp/monitoring-observability"
      version: "^2.0.0"
      components: ["MetricsCollector", "Logger"]
      
  external:
    runtime:
      - name: "axios"
        version: "^1.6.0"
        purpose: "HTTP client for REST adapter"
        
      - name: "graphql"
        version: "^16.8.0"
        purpose: "GraphQL support"
        
      - name: "@grpc/grpc-js"
        version: "^1.9.0"
        purpose: "gRPC support"
        
      - name: "ws"
        version: "^8.16.0"
        purpose: "WebSocket support"
        
      - name: "express"
        version: "^4.18.0"
        purpose: "HTTP server"
        
    development:
      - name: "@types/node"
        version: "^20.0.0"
      - name: "@types/express"
        version: "^4.17.0"

# ============================================================================
# DEPLOYMENT CONFIGURATION
# ============================================================================

deployment:
  strategy:
    type: "rolling"
    max_surge: 2
    max_unavailable: 1
    
  replicas:
    min: 3
    max: 20
    target_cpu: 70
    target_memory: 80
    
  resources:
    requests:
      cpu: "1000m"
      memory: "2Gi"
    limits:
      cpu: "4000m"
      memory: "8Gi"
      
  health_checks:
    liveness:
      path: "/health/live"
      interval: 10
      timeout: 5
      failure_threshold: 3
      
    readiness:
      path: "/health/ready"
      interval: 5
      timeout: 3
      failure_threshold: 2
      
  environment:
    - name: "NODE_ENV"
      value: "production"
    - name: "LOG_LEVEL"
      value: "info"
    - name: "ADAPTER_TIMEOUT"
      value: "30000"
    - name: "PLUGIN_SANDBOX"
      value: "true"

# ============================================================================
# VALIDATION
# ============================================================================

validation:
  pre_deployment:
    - name: "type_check"
      command: "tsc --noEmit"
      required: true
    - name: "lint"
      command: "eslint src/integration/**/*.ts"
      required: true
    - name: "unit_tests"
      command: "jest src/integration"
      required: true
      coverage_threshold: 90
    - name: "integration_tests"
      command: "jest --testPathPattern=integration"
      required: true
      
  post_deployment:
    - name: "health_check"
      endpoint: "/health"
      expected_status: 200
      timeout: 30
    - name: "adapter_test"
      endpoint: "/api/v1/adapters/test"
      method: "POST"
      expected_status: 200
      timeout: 10

# ============================================================================
# ROLLBACK CONFIGURATION
# ============================================================================

rollback:
  automatic:
    enabled: true
    conditions:
      - "health_check_failure > 3"
      - "error_rate > 5%"
      - "adapter_latency_p99 > 1s"
  manual:
    retention: 10
  strategy:
    type: "instant"
    verification_time: 120

# ============================================================================
# MONITORING & OBSERVABILITY
# ============================================================================

monitoring:
  metrics:
    - name: "integration_adapter_requests_total"
      type: "counter"
      labels: ["adapter_type", "method", "status"]
    - name: "integration_adapter_duration_seconds"
      type: "histogram"
      labels: ["adapter_type", "method"]
      buckets: [0.01, 0.05, 0.1, 0.5, 1, 5]
    - name: "integration_plugin_executions_total"
      type: "counter"
      labels: ["plugin_id", "hook"]
    - name: "integration_events_published_total"
      type: "counter"
      labels: ["event_type"]
      
  alerts:
    - name: "HighAdapterLatency"
      condition: "p99_latency > 1s"
      duration: "5m"
      severity: "warning"
    - name: "AdapterFailureRate"
      condition: "error_rate > 5%"
      duration: "5m"
      severity: "critical"

metadata:
  created_at: "2025-01-10T14:00:00Z"
  updated_at: "2025-01-11T12:00:00Z"
  version: "2.0.0"
  status: "active"
  total_components: 18
  total_size: "335 KB"
  total_lines: 9548
  layers: 4
  maintainer: "MachineNativeOps Team"