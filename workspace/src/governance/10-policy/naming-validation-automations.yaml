---
# 命名驗證自動化 | Naming Validation Automations
version: "2.0"
lastUpdated: "2025-01-05"
status: "active"
governanceDimension: "10-policy"

automation_framework:
  name: "Naming Validation Automation System"
  purpose: "自動化命名規則驗證和執行"
  principle: "Shift left - 盡早發現問題"
  integration: "CI/CD pipelines, Git hooks, IDE plugins"

# 自動化觸發點 | Automation Triggers
triggers:
  pre_commit:
    name: "Git Pre-commit Hook"
    description: "在提交代碼前自動驗證命名"
    enabled: true
    priority: "high"
    
    scope:
      - "Configuration files (YAML, JSON)"
      - "Infrastructure as Code (Terraform, CloudFormation)"
      - "Application code (naming conventions)"
      - "Documentation files"
      
    validation_rules:
      - id: "VR-001"
        name: "基本格式驗證"
        description: "驗證命名格式符合基本規則"
        rules:
          - "長度限制 (min: 3, max: 63)"
          - "字符限制 (alphanumeric, hyphens, underscores)"
          - "不以數字或特殊字符開頭"
          - "不以連字符或下劃線結尾"
          
      - id: "VR-002"
        name: "命名模式匹配"
        description: "驗證命名符合註冊的模式"
        rules:
          - "匹配至少一個註冊的命名模式"
          - "模式參數驗證"
          - "環境前綴驗證"
          
      - id: "VR-003"
        name: "唯一性檢查"
        description: "檢查命名在範圍內是否唯一"
        rules:
          - "同類型資源內唯一"
          - "檢查預留命名"
          - "檢查現有資源庫"
          
    actions:
      on_pass:
        - "允許提交"
        - "記錄驗證日誌"
        
      on_fail:
        - "拒絕提交"
        - "顯示錯誤消息"
        - "提供修正建議"
        - "生成命名建議"

  pre_push:
    name: "Git Pre-push Hook"
    description: "在推送到遠程前進行驗證"
    enabled: true
    priority: "high"
    
    scope:
      - "所有新文件"
      - "所有修改的命名相關文件"
      
    validation_rules:
      - id: "VR-004"
        name: "批量驗證"
        description: "驗證所有變更的命名"
        rules:
          - "重複預提交驗證"
          - "跨文件一致性檢查"
          - "依賴關係驗證"
          
      - id: "VR-005"
        name: "衝突檢測"
        description: "檢查與遠程倉庫的衝突"
        rules:
          - "檢查遠程資源命名"
          - "檢查待審查 RFC 中的命名"
          
    actions:
      on_pass:
        - "允許推送"
        - "推送驗證日誌"
        
      on_fail:
        - "拒絕推送"
        - "顯示衝突列表"
        - "提示先解決衝突"

  ci_pipeline:
    name: "CI Pipeline Validation"
    description: "在 CI/CD 流水線中進行驗證"
    enabled: true
    priority: "critical"
    
    scope:
      - "Pull Request/Merge Request"
      - "Main branch build"
      - "Release builds"
      
    validation_rules:
      - id: "VR-006"
        name: "全面驗證"
        description: "執行所有驗證規則"
        rules:
          - "所有預提交規則"
          - "跨項目一致性"
          - "架構合規性"
          - "安全命名檢查"
          
      - id: "VR-007"
        name: "影響分析"
        description: "分析命名的影響範圍"
        rules:
          - "識別依賴關係"
          - "評估影響範圍"
          - "檢查潛在衝突"
          
    actions:
      on_pass:
        - "允許合併"
        - "生成驗證報告"
        - "更新儀表板"
        
      on_fail:
        - "阻止合併"
        - "標記 PR 失敗"
        - "通知命名門戶"
        - "生成修復建議"

  scheduled_scan:
    name: "Scheduled Validation Scan"
    description: "定期掃描現有資源"
    enabled: true
    priority: "medium"
    schedule: "daily"
    
    scope:
      - "所有資源庫"
      - "生產環境資源"
      - "配置倉庫"
      
    validation_rules:
      - id: "VR-008"
        name: "持續合規性檢查"
        description: "檢查資源的持續合規性"
        rules:
          - "檢查是否仍符合最新標準"
          - "識別漂移"
          - "檢查棄用的命名模式"
          
      - id: "VR-009"
        name: "安全審查"
        description: "檢查安全相關命名"
        rules:
          - "敏感資源命名審查"
          - "訪問控制命名檢查"
          - "機密性標記驗證"
          
    actions:
      on_issues_found:
        - "生成違規報告"
        - "創建 Jira 工單"
        - "通知相關團隊"
        - "更新違規計數"

# 驗證規則引擎 | Validation Rules Engine
rules_engine:
  pattern_matching:
    regex_based:
      enabled: true
      patterns:
        - name: "resource_standard"
          pattern: "^(?<env>[a-z]+)-(?<team>[a-z]+)-(?<service>[a-z]+)-(?<type>[a-z]+)-(?<id>[0-9]+)$"
          description: "標準資源命名模式"
          
        - name: "service_standard"
          pattern: "^(?<service>[a-z]+)-(?<env>[a-z]+)$"
          description: "服務命名模式"
          
    semantic_validation:
      enabled: true
      rules:
        - "env 必須是有效的環境名稱"
        - "team 必須在註冊的團隊列表中"
        - "type 必須是有效的資源類型"
        - "id 必須是唯一的"

  consistency_checks:
    cross_reference:
      enabled: true
      checks:
        - "資源間引用關係驗證"
        - "配置間一致性檢查"
        - "文檔與實現匹配"
        
    naming_convention:
      enabled: true
      checks:
        - "同一類型資源使用相同模式"
        - "環境前綴一致性"
        - "大小寫使用一致性"

  security_checks:
    sensitive_resources:
      enabled: true
      checks:
        - "敏感資源必須包含安全標記"
        - "機密資源命名必須符合額外規則"
        - "生產環境資源必須有生產標記"
        
    access_control:
      enabled: true
      checks:
        - "訪問控制資源命名必須明確"
        - "角色和權限命名必須標準化"

# 自動化修復 | Automated Remediation
remediation:
  suggestions:
    enabled: true
    capabilities:
      - id: "AR-001"
        name: "自動重命名建議"
        description: "基於模式生成正確命名"
        algorithm: "Pattern-based generation"
        
      - id: "AR-002"
        name: "衝突解決建議"
        description: "提供解決命名衝突的建議"
        algorithm: "Conflict resolution heuristics"
        
      - id: "AR-003"
        name: "最佳實踐建議"
        description: "提供命名最佳實踐建議"
        algorithm: "Best practice rules"

  auto_fix:
    non_critical:
      enabled: true
      scope:
        - "格式問題（大小寫、分隔符）"
        - "明顯的拼寫錯誤"
        - "過時的模式替換"
      conditions:
        - "不影響功能性"
        - "不會導致服務中斷"
        - "低風險"
        
    critical:
      enabled: false
      requires_approval: true
      scope:
        - "所有重命名操作"
        - "架構變更"
      approval_process: "RFC workflow"

# 集成點 | Integration Points
integrations:
  ide_plugins:
    vscode:
      enabled: true
      features:
        - "實時命名驗證"
        - "命名建議補全"
        - "快捷鍵快速重命名"
        - "錯誤高亮顯示"
        
    jetbrains:
      enabled: true
      features:
        - "實時檢查"
        - "批量重命名工具"
        - "命名模式模板"
        
    visual_studio:
      enabled: true
      features:
        - "實時驗證"
        - "命名重構工具"
        
  git_platforms:
    github:
      enabled: true
      features:
        - "Pull Request status checks"
        - "Comment suggestions"
        - "Automated label assignment"
        
    gitlab:
      enabled: true
      features:
        - "Merge Request rules"
        - "Pipeline integration"
        - "Inline comments"
        
  ci_cd_platforms:
    jenkins:
      enabled: true
      stages:
        - "validation"
        - "security-scan"
        
    github_actions:
      enabled: true
      workflows:
        - "naming-validation.yml"
        
    gitlab_ci:
      enabled: true
      stages:
        - "validate"
        - "test"

  issue_tracking:
    jira:
      enabled: true
      automation:
        - "Auto-create violation tickets"
        - "Auto-assign to responsible team"
        - "Auto-update ticket status"
        
  notification:
    slack:
      enabled: true
      channels:
        - "naming-violations"
        - "ci-build-status"
        
    email:
      enabled: true
      triggers:
        - "Critical violations"
        - "Failed CI builds"

# 性能優化 | Performance Optimization
performance:
  caching:
    enabled: true
    strategy:
      - "Pattern cache (TTL: 1 hour)"
      - "Resource inventory cache (TTL: 5 minutes)"
      - "Team list cache (TTL: 1 day)"
      
  parallel_processing:
    enabled: true
    batch_size: 100
    max_workers: 4
    
  incremental_validation:
    enabled: true
    strategy:
      - "只驗證變更的文件"
      - "差異分析"
      - "緩存驗證結果"

# 報告和分析 | Reporting and Analytics
reporting:
  validation_reports:
    pre_commit:
      enabled: true
      format: "console output"
      details: "summary"
      
    ci_pipeline:
      enabled: true
      format: "HTML report"
      details: "detailed"
      artifacts:
        - "validation-results.html"
        - "violations.json"
        
    scheduled_scan:
      enabled: true
      format: "PDF report + JSON"
      details: "comprehensive"
      distribution:
        - "Email to team leads"
        - "Upload to dashboard"
        
  metrics:
    collection:
      enabled: true
      metrics:
        - "Validation success rate"
        - "Validation duration"
        - "Most common violations"
        - "Team compliance rates"
        
    export:
      enabled: true
      destinations:
        - "Prometheus"
        - "Grafana"
        - "Custom analytics"

# 錯誤處理 | Error Handling
error_handling:
  retry_logic:
    max_retries: 3
    backoff: "exponential"
    retry_on:
      - "Network errors"
      - "Temporary failures"
      
  fallback:
    on_validation_failure:
      action: "Block and notify"
      notify:
        - "Naming Gatekeeper"
        - "Team Lead"
        
  graceful_degradation:
    on_service_unavailable:
      action: "Fail open with warning"
      log_level: "warning"
      notify: ["Operations team"]

# 擴展性 | Extensibility
custom_rules:
  supported: true
  format: "Python scripts"
  location: "custom_rules/"
  documentation: "https://docs.example.com/custom-rules"
  
  examples:
    - name: "business_specific_validation"
      description: "驗證業務特定的命名規則"
      template: "business_rule_template.py"
      
    - name: "team_convention"
      description: "驗證團隊特定的命名約定"
      template: "team_rule_template.py"

plugin_system:
  enabled: true
  api_version: "v2"
  
  hooks:
    - "before_validation"
    - "after_validation"
    - "on_violation"
    - "on_success"
    
  available_plugins:
    - "AI-naming-suggestion"
    - "legacy-system-mapper"
    - "compliance-checker"